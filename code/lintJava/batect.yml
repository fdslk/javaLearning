containers:
  build-env:
    image: maven:3.6.0-jdk-11-slim
    volumes:
      - local: .
        container: /code
        options: cached
      - local: ~/.m2
        container: /home/container-user/.m2
        options: cached
    run_as_current_user:
      enabled: true
      home_directory: /home/container-user
    working_directory: /code

tasks:
  buildEnv:
    description: Start a shell in the development environment
    run:
      container: build-env
      command: bash

  lint:
    description: generate lint report
    run:
      container: build-env
      command: mvn site -e

  unitTest:
    description: unit test for demo
    run:
      container: build-env
      command: mvn clean test